@using LinqStudio.Core.Models

<MudDialog>
	<DialogContent>
		<MudTextField @bind-Value="_projectName" 
					  Label="Project Name" 
					  Required="true"
					  Immediate="true" />
		
		<MudTextField @bind-Value="_connectionString" 
					  Label="Connection String" 
					  Class="mt-4"
					  Lines="3" />
	</DialogContent>
	<DialogActions>
		<MudButton OnClick="Cancel">Cancel</MudButton>
		<MudButton Color="Color.Primary" 
				   Variant="Variant.Filled" 
				   OnClick="Save"
				   Disabled="@string.IsNullOrWhiteSpace(_projectName)">
			Save
		</MudButton>
	</DialogActions>
</MudDialog>

@code {
	[CascadingParameter] 
	private IMudDialogInstance MudDialog { get; set; } = null!;
	
	[Parameter]
	public Project Project { get; set; } = null!;

	private string _projectName = string.Empty;
	private string _connectionString = string.Empty;

	protected override void OnInitialized()
	{
		_projectName = Project.Name;
		_connectionString = Project.ConnectionString;
	}

	private void Cancel() => MudDialog.Cancel();

	private void Save()
	{
		var updatedProject = Project with
		{
			Name = _projectName,
			ConnectionString = _connectionString
		};
		
		MudDialog.Close(DialogResult.Ok(updatedProject));
	}
}